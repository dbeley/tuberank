{% load humanize %}
{% load i18n %}
{% load ratings_extras %}

<div class="bg-white rounded-lg shadow-lg overflow-hidden flex flex-col justify-between">
    <a href="{% url 'video_details' pk=video.id %}">
        <img src="{{ video.last_snapshot.thumbnail_url }}" alt="{{ video.last_snapshot.title_en }}" class="h-48 w-full object-cover">
    </a>
    <div class="p-4">
        <a href="{% url 'video_details' pk=video.id %}">
            <h3 class="font-semibold text-gray-900 mb-2 text-lg">{{ video.last_snapshot.title_en }}</h3>
        </a>
        <a href="{% url 'channel_details' pk=video.channel.id %}"> <p class="text-gray-700 text-md mb-2">{{ video.channel.last_snapshot.name_en }}</p></a>
        {% if not video.ratings.count == 0 %}
        <p class="text-gray-700 text-sm mb-2">{% blocktranslate with rating=video.average_rating|custom_rating count=video.ratings.count %}Rating: {{ rating }} from {{ count }} ratings{% endblocktranslate %}</p>
        {% endif %}
        <p class="text-gray-700 text-sm mb-2">{% blocktranslate with count=video.last_snapshot.count_views|intcomma %}{{ count }} views{% endblocktranslate %}</p>
    </div>
    <div class="flex justify-end p-4">
        <a href="{{ video.url }}" target="_blank" class="bg-blue-500 hover:bg-blue-700 text-white text-sm font-bold py-2 px-4 rounded">
            {% translate "Watch on YouTube" %}
        </a>
        {% if user.is_authenticated %}
        <a href="{% url 'video_rating' pk=video.id %}" class="ml-4 bg-gray-500 hover:bg-gray-700 text-white text-sm font-bold py-2 px-4 rounded">
            {% translate "Rate this video" %}
        </a>
        {% if list %}
        <a href="{% url 'list_delete_item' list_pk=list.id video_pk=video.id %}" class="ml-4 bg-gray-500 hover:bg-gray-700 text-white text-sm font-bold py-2 px-4 rounded">
            {% translate "Delete item from list" %}
        </a>
        {% endif %}
        {% if tag %}
        <a href="{% url 'tag_delete_item' tag_name=tag.name video_pk=video.id %}" class="ml-4 bg-gray-500 hover:bg-gray-700 text-white text-sm font-bold py-2 px-4 rounded">
            {% translate "Delete tag from list" %}
        </a>
        {% endif %}
        {% endif %}
    </div>
</div>
